{% extends 'base.html' %}

{% block header %}
  <h1>{% block title %}Favorites - Search for your favorite birds{% endblock %}</h1>
{% endblock %}

{% block content %}
  <article class="post">
    <header>
      <div>
        <form method="">
          <label for="search">Search By Common or Scientific Name</label>
          <input type="searh" name="search" id="search" required>
          <input type="submit" value="Search" class="favorite-search">
        </form>
      </div>
    </header>
  </article>
  <section class="search-results">
    <button onclick="addFavoriteBirds()" class="add-birds">Add Favorite Birds</button>
  </section>
  <script type="text/javascript">
    $(".add-birds").hide();
    var searchButton = $(".favorite-search")

    searchButton.on('click', function() {
      fetchBirds()
    })

    const fetchBirds = () => {
      header = {headers: {'X-eBirdApiToken': 'hv9rjmnpb5vo' }}
      fetch('https://ebird.org/ws2.0/data/obs/geo/recent?lat=39.94&lng=-105.27&dist=10', header)
        .then((response) => response.json())
        .then((birds) => {
          birds.sort(function(a, b) {
            if (a.comName < b.comName) {
              return 1;
            } else {
              return -1;
            }
          });
          birds.forEach((bird) => {
            if (bird.comName.includes("sp.")) {
            } else {
              $(".search-results").prepend(`<input type="checkbox" value="${bird.comName}">${bird.comName} (${bird.sciName}) -- ${bird.speciesCode}</option><br>`)
            }
          })
          $(".add-birds").show();
        })
    };
  </script>


{% endblock %}
